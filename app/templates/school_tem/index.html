{% extends "school_tem/layout.html" %}
{% block header %}
    <style>
        .fa-check:before {
            content: "\f0ae";
        }

    </style>
    <script src="https://code.highcharts.com/highcharts.js"></script>
    <script src="https://code.highcharts.com/modules/exporting.js"></script>
    <script src="https://code.highcharts.com/modules/export-data.js"></script>
{% endblock %}
{% block content %}
    <div class="copyrights">Collect from <a href="http://www.cssmoban.com/" title="网站模板">网站模板</a></div>
    <div id="page-wrapper">

        <div class="row">
            <div class="col-lg-12">
                <h1>控制台
                    {#                <small>Statistics Overview</small>#}
                </h1>
                {#            <ol class="breadcrumb">#}
                {#              <li class="active"><i class="fa fa-dashboard"></i> Dashboard</li>#}
                {#            </ol>#}
                {#            <div class="alert alert-success alert-dismissable">#}
                {#              <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>#}
                {#              Welcome to SB Admin by <a class="alert-link" href="http://startbootstrap.com">Start Bootstrap</a>! Feel free to use this template for your admin needs! We are using a few different plugins to handle the dynamic tables and charts, so make sure you check out the necessary documentation links provided.#}
                {#            </div>#}
            </div>
        </div><!-- /.row -->

        <div class="row">
            <div class="col-lg-3">
                <div class="panel panel-info">
                    <div class="panel-heading">
                        <div class="row">
                            <div class="col-xs-6">
                                <i class="fa fa-comments fa-5x"></i>
                            </div>
                            <div class="col-xs-6 text-right">
                                <p class="announcement-heading">{{ studentlist | length }}</p>
                                <p class="announcement-text">学生数量</p>
                            </div>
                        </div>
                    </div>
                    <a href="#">
                        <div class="panel-footer announcement-bottom">
                            <div class="row">
                                <div class="col-xs-6">
                                    学生信息
                                </div>
                                <div class="col-xs-6 text-right">
                                    <a href="Student_info"><i class="fa fa-arrow-circle-right"></i></a>
                                </div>
                            </div>
                        </div>
                    </a>
                </div>
            </div>
            <div class="col-lg-3">
                <div class="panel panel-warning">
                    <div class="panel-heading">
                        <div class="row">
                            <div class="col-xs-6">
                                <i class="fa fa-check fa-5x"></i>
                            </div>
                            <div class="col-xs-6 text-right">
                                <p class="announcement-heading">{{ teacherlist|length }}</p>
                                <p class="announcement-text">教师数量</p>
                            </div>
                        </div>
                    </div>
                    <a href="#">
                        <div class="panel-footer announcement-bottom">
                            <div class="row">
                                <div class="col-xs-6">
                                    教师信息
                                </div>
                                <div class="col-xs-6 text-right">
                                    <a href="Teacher_info"><i class="fa fa-arrow-circle-right"></i></a>
                                </div>
                            </div>
                        </div>
                    </a>
                </div>
            </div>
            <div class="col-lg-3">
                <div class="panel panel-danger">
                    <div class="panel-heading">
                        <div class="row">
                            <div class="col-xs-6">
                                <i class="fa fa-tasks fa-5x"></i>
                            </div>
                            <div class="col-xs-6 text-right">
                                <p class="announcement-heading">{{ subjectlist|length }}</p>
                                <p class="announcement-text">学科数量</p>
                            </div>
                        </div>
                    </div>
                    <a href="#">
                        <div class="panel-footer announcement-bottom">
                            <div class="row">
                                <div class="col-xs-6">
                                    学科信息
                                </div>
                                <div class="col-xs-6 text-right">
                                    <a href="Subject_info"><i class="fa fa-arrow-circle-right"></i></a>
                                </div>
                            </div>
                        </div>
                    </a>
                </div>
            </div>
            <div class="col-lg-3">
                <div class="panel panel-success">
                    <div class="panel-heading">
                        <div class="row">
                            <div class="col-xs-6">
                                <i class="fa fa-comments fa-5x"></i>
                            </div>
                            <div class="col-xs-6 text-right">
                                <p class="announcement-heading">56</p>
                                <p class="announcement-text">缴费信息</p>
                            </div>
                        </div>
                    </div>
                    <a href="#">
                        <div class="panel-footer announcement-bottom">
                            <div class="row">
                                <div class="col-xs-6">
                                    缴费信息
                                </div>
                                <div class="col-xs-6 text-right">
                                    <a href="Price_info"><i class="fa fa-arrow-circle-right"></i></a>
                                </div>
                            </div>
                        </div>
                    </a>
                </div>
            </div>
        </div><!-- /.row -->

        <div class="row">

            <div class="col-lg-12">
                <div class="panel panel-primary">
                    <div class="panel-heading">
                        <h3 class="panel-title"><i class="fa fa-bar-chart-o"></i> Traffic Statistics: October 1, 2013 -
                            October 31, 2013</h3>
                    </div>
                    <div class="panel-body">
                        <div id="morris-chart-area"></div>

                    </div>
                </div>
            </div>
        </div><!-- /.row -->

        <div class="row">
            <div class="col-lg-6">
                <div class="panel panel-primary">
                    <div class="panel-heading">
                        <h3 class="panel-title"><i class="fa fa-long-arrow-right" id="title-time"></i></h3>
                    </div>
                    <div class="panel-body">
                        {#                <div id="morris-chart-donut"></div>#}
                        <div id="container"
                             style="min-width: 310px; height: 400px; max-width: 660px; margin: 0 50px"></div>

                        <div class="text-right">
                            <a href="#">View Details <i class="fa fa-arrow-circle-right"></i></a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-4">

                <div class="panel panel-primary">
                    <div class="panel-heading">
                        <h3 class="panel-title"><i class="fa fa-clock-o"></i> 缴费信息</h3>
                    </div>
                    <div class="panel-body">
                        <div class="list-group">
                            <a href="#" class="list-group-item">

                                <span class="badge">just now</span>
                                <i class="fa fa-calendar"></i> Calendar updated
                            </a>
                            <a href="#" class="list-group-item">
                                <span class="badge">4 minutes ago</span>
                                <i class="fa fa-comment"></i> Commented on a post
                            </a>
                            <a href="#" class="list-group-item">
                                <span class="badge">23 minutes ago</span>
                                <i class="fa fa-truck"></i> Order 392 shipped
                            </a>
                            <a href="#" class="list-group-item">
                                <span class="badge">46 minutes ago</span>
                                <i class="fa fa-money"></i> Invoice 653 has been paid
                            </a>
                            <a href="#" class="list-group-item">
                                <span class="badge">1 hour ago</span>
                                <i class="fa fa-user"></i> A new user has been added
                            </a>
                            <a href="#" class="list-group-item">
                                <span class="badge">2 hours ago</span>
                                <i class="fa fa-check"></i> Completed task: "pick up dry cleaning"
                            </a>
                            <a href="#" class="list-group-item">
                                <span class="badge">yesterday</span>
                                <i class="fa fa-globe"></i> Saved the world
                            </a>
                            <a href="#" class="list-group-item">
                                <span class="badge">two days ago</span>
                                <i class="fa fa-check"></i> Completed task: "fix error on sales page"
                            </a>
                        </div>
                        <div class="text-right">
                            <a href="#">View All Activity <i class="fa fa-arrow-circle-right"></i></a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-5">
                <div class="panel panel-primary">
                    <div class="panel-heading">
                        <h3 class="panel-title"><i class="fa fa-money"></i> 缴费告警</h3>
                    </div>
                    <div class="panel-body">
                        <div class="table-responsive">
                            <table class="table table-bordered table-hover table-striped tablesorter">
                                <thead>
                                <tr>
                                    <th> 学生姓名 <i class="fa fa-sort"></i></th>
                                    <th>教师姓名 <i class="fa fa-sort"></i></th>
                                    <th>学科名称 <i class="fa fa-sort"></i></th>
                                    <th>开始时间 <i class="fa fa-sort"></i></th>
                                    <th>截止时间 <i class="fa fa-sort"></i></th>
                                    <th>课时 <i class="fa fa-sort"></i></th>
                                    <th>费用 (USD) <i class="fa fa-sort"></i></th>
                                </tr>
                                </thead>
                                <tbody>
                                {% set flag=1 %}

                                {% for warn in pricewarn %}

                                    <tr id="danger{{ loop.index }}">

                                        <td name="student_name">{{ warn.student_name }}</td>
                                        <td name="student_name">{{ warn.student_name }}</td>
                                        <td name="subject_name">{{ warn.subject_name }}</td>
                                        <td name="startTime">{{ warn.startTime }}</td>
                                        <td name="stopTime">{{ warn.stopTime }}</td>
                                        <td name="ClassHours">{{ warn.ClassHours }}</td>
                                        <td name="prices">{{ warn.prices }}</td>

                                    </tr>

                                {% endfor %}


                                </tbody>
                            </table>
                        </div>
                        <div class="text-right">
                            <a href="#">View All Transactions <i class="fa fa-arrow-circle-right"></i></a>
                        </div>
                    </div>
                </div>
            </div>
        </div><!-- /.row -->

    </div><!-- /#page-wrapper -->

{% endblock %}
{% block foot %}


    <!-- Page Specific Plugins -->
    <script src="js/raphael-min.js"></script>
    <script src="js/morris-0.4.3.min.js"></script>
    <script src="js/morris/chart-data-morris.js"></script>

    <script src="js/highcharts_substu.js"></script>
    <script src="js/timeInterval.js"></script>
    <script>
        $(document).ready(function () {


            var timeclock = window.setInterval(tr_warn, 1500);
            var jsondata = [];

            function tr_warn() {
                for (var i = 1; i <={{ pricewarn|count }}; i++) {
                    if (document.getElementById("danger" + i).className != "danger") {
                        document.getElementById("danger" + i).className = "danger"
                    } else {
                        document.getElementById("danger" + i).className = ""
                    }
                }
            }

            $.ajax({
                url: "{{ url_for("web.SubStuCount") }}",
                async: false,
                type: "POST",
                success: function (result) {

            	 var json = result;

                 for (var i in json) {
                     jsondata.push( json[i]);
                 }

                }
            })

            var chart=new Highcharts.chart('container', {
                chart: {
                    plotBackgroundColor: null,
                    plotBorderWidth: null,
                    plotShadow: false,
                    type: 'pie',
                    height:400, width:650
                },
                title: false,
                tooltip: {
                    pointFormat: '{point.subject_name}: 学生数量<b>{point.x}人</b>'
                },
                plotOptions: {
                    pie: {
                        allowPointSelect: true,
                        cursor: 'pointer',
                        dataLabels: {
                            enabled: true,
                            format: '<b>{point.subject_name}</b>: 学生数量{point.x}人 {point.y:.1f} %'
                        }
                    }
                },
                series: [{
                    name: 'Brands',
                    colorByPoint: true,
                    data: jsondata

                }]
            });
        })

    </script>



{% endblock %}